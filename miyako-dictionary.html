<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å®®å¤èªè¾æ›¸</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: 'Hiragino Sans', 'Yu Gothic', sans-serif; background: linear-gradient(135deg, #3949ab 0%, #1a237e 100%); min-height: 100vh; padding: 20px; }
        .container { max-width: 950px; margin: 0 auto; background: white; border-radius: 16px; box-shadow: 0 20px 60px rgba(0,0,0,0.3); overflow: hidden; }
        header { background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%); color: white; padding: 30px; text-align: center; }
        header h1 { font-size: 28px; margin-bottom: 8px; }
        header p { opacity: 0.8; font-size: 14px; }
        .search-section { padding: 20px 30px; background: #f8f9fa; border-bottom: 1px solid #e9ecef; }
        .mode-toggle { display: flex; gap: 0; margin-bottom: 15px; border-radius: 8px; overflow: hidden; border: 2px solid #3949ab; }
        .mode-btn { flex: 1; padding: 10px 20px; border: none; background: white; cursor: pointer; font-size: 14px; font-weight: bold; color: #3949ab; transition: all 0.2s; }
        .mode-btn:hover { background: #f0f0ff; }
        .mode-btn.active { background: #3949ab; color: white; }
        #searchInput { width: 100%; padding: 12px 16px; border: 2px solid #dee2e6; border-radius: 8px; font-size: 16px; margin-bottom: 10px; }
        #searchInput:focus { outline: none; border-color: #3949ab; }
        .search-options { display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 15px; align-items: center; }
        .search-options label { font-size: 12px; color: #6c757d; margin-right: 5px; }
        .search-option { display: flex; align-items: center; gap: 4px; font-size: 12px; cursor: pointer; padding: 4px 10px; background: #f8f9fa; border-radius: 4px; border: 1px solid #dee2e6; }
        .search-option:hover { background: #e9ecef; }
        .search-option input { margin: 0; cursor: pointer; }
        .search-option.active { background: #3949ab; color: white; border-color: #3949ab; }
        .search-targets { display: flex; flex-wrap: wrap; gap: 6px; margin-left: auto; }
        .search-target { font-size: 11px; padding: 3px 8px; background: #e9ecef; border-radius: 3px; cursor: pointer; }
        .search-target:hover { background: #dee2e6; }
        .search-target.active { background: #28a745; color: white; }
        .alphabet-nav { display: flex; flex-wrap: wrap; gap: 4px; margin-bottom: 15px; }
        .alphabet-nav button { padding: 6px 10px; border: none; background: #e9ecef; border-radius: 4px; cursor: pointer; font-size: 13px; }
        .alphabet-nav button:hover { background: #3949ab; color: white; }
        .alphabet-nav button.active { background: #1a237e; color: white; }
        .filter-section { display: flex; flex-wrap: wrap; gap: 8px; }
        .filter-btn { padding: 6px 12px; border: none; background: #e9ecef; border-radius: 20px; cursor: pointer; font-size: 12px; }
        .filter-btn:hover { background: #dee2e6; }
        .filter-btn.active { background: #3949ab; color: white; }
        .stats { padding: 10px 30px; background: #fff3cd; font-size: 13px; color: #856404; }
        .dictionary-list { max-height: 60vh; overflow-y: auto; }
        .entry { padding: 20px 30px; border-bottom: 1px solid #e9ecef; }
        .entry:hover { background: #fafbfc; }
        .entry-header { display: flex; align-items: baseline; gap: 12px; margin-bottom: 8px; flex-wrap: wrap; }
        .morph { font-size: 26px; font-weight: bold; color: #1a1a2e; }
        .morph-index { font-size: 14px; color: #6c757d; vertical-align: super; }
        .pos-badge { padding: 3px 10px; border-radius: 4px; font-size: 12px; font-weight: bold; }
        .gloss-main { font-size: 18px; color: #2d3436; }
        .entry-header.reverse .gloss-main { font-size: 24px; font-weight: bold; color: #1a1a2e; order: -1; }
        .entry-header.reverse .morph { font-size: 20px; color: #3949ab; }
        .allomorphs { font-size: 13px; color: #6c757d; margin: 8px 0; padding: 6px 10px; background: #f8f9fa; border-radius: 4px; border-left: 3px solid #856404; }
        .allomorphs::before { content: "ç•°å½¢æ…‹: "; font-weight: bold; color: #856404; }
        .allomorph-item { display: inline-block; background: #e9ecef; padding: 2px 8px; border-radius: 3px; margin: 2px 3px 2px 0; font-family: monospace; font-size: 14px; }
        .examples-section { margin-top: 12px; padding-top: 12px; border-top: 1px dashed #dee2e6; }
        .examples-title { font-size: 12px; font-weight: bold; color: #6c757d; margin-bottom: 8px; }
        .example { margin-bottom: 12px; padding: 10px; background: linear-gradient(135deg, #f5f7fa 0%, #e8ecf1 100%); border-radius: 8px; font-size: 13px; }
        .example-header { display: flex; align-items: center; gap: 10px; margin-bottom: 6px; }
        .play-btn { width: 32px; height: 32px; border: none; border-radius: 50%; background: linear-gradient(135deg, #3949ab 0%, #1a237e 100%); color: white; cursor: pointer; font-size: 14px; display: flex; align-items: center; justify-content: center; flex-shrink: 0; transition: all 0.2s; }
        .play-btn:hover { transform: scale(1.1); box-shadow: 0 3px 10px rgba(102,126,234,0.4); }
        .play-btn.playing { background: #e74c3c; }
        .example-text { font-size: 14px; color: #1a1a2e; line-height: 1.5; font-weight: 500; flex: 1; }
        .example-trans { font-size: 13px; color: #2d3436; margin-bottom: 8px; padding: 6px 10px; background: #fff; border-radius: 4px; border-left: 3px solid #3949ab; }
        .example-trans::before { content: "è¨³: "; font-weight: bold; color: #3949ab; }
        .interlinear { display: flex; flex-wrap: wrap; gap: 2px; font-family: 'Consolas', 'Monaco', monospace; padding-top: 8px; border-top: 1px solid #dee2e6; }
        .gloss-unit { display: flex; flex-direction: column; align-items: center; padding: 3px 5px; margin-right: 4px; border-radius: 3px; background: #fff; }
        .gloss-unit.target { background: #fff3cd; border: 2px solid #ffc107; }
        .gloss-unit .morph-text { font-size: 13px; color: #1a1a2e; font-weight: 500; }
        .gloss-unit .gloss-text { font-size: 10px; color: #6c757d; }
        .gloss-unit.target .morph-text { color: #856404; font-weight: bold; }
        .gloss-unit.target .gloss-text { color: #856404; }
        .pos-V { background: #cce5ff; color: #004085; } .pos-N { background: #d4edda; color: #155724; } .pos-AUX { background: #fff3cd; color: #856404; } .pos-ADJ { background: #f8d7da; color: #721c24; } .pos-ADV { background: #e2d5f1; color: #5a2d82; } .pos-PRN { background: #d1ecf1; color: #0c5460; } .pos-CONJ { background: #d4edda; color: #155724; } .pos-CP { background: #ffeaa7; color: #856404; } .pos-ISP { background: #dfe6e9; color: #2d3436; } .pos-SFP { background: #fab1a0; color: #6c3d00; } .pos-INTJ { background: #fd79a8; color: #6c1e3d; } .pos-VAFX { background: #74b9ff; color: #003366; } .pos-NAFX { background: #a29bfe; color: #2d1f5c; } .pos-FN { background: #81ecec; color: #006266; } .pos-PN { background: #ffeaa7; color: #6c5000; } .pos-NUM { background: #fdcb6e; color: #5a4000; } .pos-CJP { background: #00cec9; color: #006266; } .pos-LP { background: #a8e6cf; color: #1b5e20; } .pos-CLF { background: #b2bec3; color: #2d3436; } .pos-default { background: #e9ecef; color: #495057; }
        .no-results { padding: 40px; text-align: center; color: #6c757d; }
        footer { padding: 15px 30px; background: #f8f9fa; text-align: center; font-size: 12px; color: #6c757d; }
        .highlight { background: #fff3cd; padding: 0 2px; border-radius: 2px; }
        .csv-btn { padding: 8px 16px; background: #28a745; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 13px; margin-left: 10px; }
        .csv-btn:hover { background: #218838; }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸï¸ å®®å¤èªè¾æ›¸</h1>
            <p>Miyako Language Dictionary</p>
        </header>
        <div class="search-section">
            <div class="mode-toggle">
                <button class="mode-btn active" id="modeNormal">è¦‹å‡ºã—é †ï¼ˆå®®å¤èªâ†’æ„å‘³ï¼‰</button>
                <button class="mode-btn" id="modeReverse">é€†å¼•ãï¼ˆæ„å‘³â†’å®®å¤èªï¼‰</button>
            </div>
            <input type="text" id="searchInput" placeholder="å½¢æ…‹ç´ ãƒ»æ„å‘³ãƒ»å“è©ãƒ»å’Œè¨³ã‚’æ¤œç´¢...">
            <div class="search-options">
                <label>æ¤œç´¢æ–¹æ³•:</label>
                <span class="search-option active" data-mode="partial">éƒ¨åˆ†ä¸€è‡´</span>
                <span class="search-option" data-mode="exact">å®Œå…¨ä¸€è‡´</span>
                <span class="search-option" data-mode="prefix">å‰æ–¹ä¸€è‡´</span>
                <span class="search-option" data-mode="suffix">å¾Œæ–¹ä¸€è‡´</span>
                <div class="search-targets">
                    <span class="search-target active" data-target="morph">å½¢æ…‹ç´ </span>
                    <span class="search-target active" data-target="gloss">æ„å‘³</span>
                    <span class="search-target active" data-target="pos">å“è©</span>
                    <span class="search-target active" data-target="trans">å’Œè¨³</span>
                    <span class="search-target active" data-target="allo">ç•°å½¢æ…‹</span>
                </div>
            </div>
            <div class="alphabet-nav" id="alphabetNav"></div>
            <div class="filter-section" id="posFilters"></div>
        </div>
        <div class="stats" id="stats"></div>
        <div class="dictionary-list" id="dictionaryList"></div>
        <footer>å®®å¤èªè¾æ›¸ | ç·è¦‹å‡ºã—èªæ•°: <span id="totalCount">0</span>èª | ğŸ”Š ä¾‹æ–‡ã‚’ã‚¯ãƒªãƒƒã‚¯ã§éŸ³å£°å†ç”Ÿ <button class="csv-btn" onclick="downloadCSV()">ğŸ“¥ CSVãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</button></footer>
        <audio id="mainAudio" style="display:none;"></audio>
    </div>
<script>
const dictionaryData = [{"morph":"-fÉ¨","pos":"AAFX","gloss":"VLZ","allomorphs":[],"examples":[{"text":"mura=kara=mai icban aparagi-munu=n mmja uu-fÉ¨ nar-i-i nar-i-u-tar=ca","trans":"æ‘ã§ã‚‚ä¸€ç•ªã®ç¾äººã«æˆé•·ã—ãŸã‚“ã ã¨ã•ã€‚","morphs":["mura","=kara","=mai","icban","aparagi","-munu","=n","mmja","uu","-fÉ¨","nar","-i","-i","nar","-i","-u","-tar","=ca"],"glosses":["æ‘","ABL","ADD","ä¸€ç•ª","ç¾ã—ã„","ADJ","DAT","DSC","å¤§ãã„","VLZ","ãªã‚‹","THM","SEQ","ãªã‚‹","THM","PROG","PST","HS"],"pos_list":["N","CP","LP","ADV","ADJ","AAFX","CP","INTJ","ADJ","AAFX","V","VAFX","VAFX","V","VAFX","AUX","VAFX","SFP"],"target_index":9,"audio_file":"https://zenodo.org/api/records/17774723/files/004_murakaramai_icban_aparagi-mu.wav/content?download=1","start_time":0,"end_time":0}],"morph_index":null},{"morph":"-gama","pos":"NAFX","gloss":"DIM","allomorphs":[],"examples":[{"text":"nkjaan=du anna=tu uja=tu tamamiga=ti asÉ¨ ffa-gama=nu u-tar=ca","trans":"æ˜”ã€…ã€æ¯è¦ªã¨çˆ¶è¦ªã¨ã‚¿ãƒãƒŸã‚¬ã¨ã„ã†å­ä¾›ãŒã„ãŸã‚“ã ã¨ã•ã€‚","morphs":["nkjaan","=du","anna","=tu","uja","=tu","tamamiga","=ti","asÉ¨","ffa","-gama","=nu","u","-tar","=ca"],"glosses":["æ˜”","FOC","æ¯è¦ª","COM","çˆ¶è¦ª","COM","ã‚¿ãƒãƒŸã‚¬","QUOT","è¨€ã†","å­","DIM","NOM","ã„ã‚‹","PST","HS"],"pos_list":["N","ISP","N","CP","N","CP","N","CJP","V","N","NAFX","CP","V","VAFX","SFP"],"target_index":10,"audio_file":"https://zenodo.org/api/records/17774723/files/002_nkjaandu_annatu_ujatu_tamam.wav/content?download=1","start_time":0,"end_time":0},{"text":"unu ffa-gama=a dondon dondon aparagi-midum-mas-i-i sudac-i-i","trans":"ãã®å­ä¾›ã¯ã©ã‚“ã©ã‚“ã©ã‚“ã©ã‚“ç¾ã—ã„å¥³ã«è‚²ã£ã¦","morphs":["unu","ffa","-gama","=a","dondon","dondon","aparagi","midum","-mas","-i","-i","sudac","-i","-i"],"glosses":["ãã®","å­","DIM","TOP","ONM","ONM","ç¾ã—ã„","å¥³","CVLZ","THM","SEQ","è‚²ã¤","THM","SEQ"],"pos_list":["ADN","N","NAFX","ISP","INTJ","INTJ","ADJ","N","XAFX","VAFX","VAFX","V","VAFX","VAFX"],"target_index":2,"audio_file":"https://zenodo.org/api/records/17774723/files/003_unu_ffa-gamaa_dondon_dondon_a.wav/content?download=1","start_time":0,"end_time":0}],"morph_index":null},{"morph":"-i","pos":"VAFX","gloss":"THM","allomorphs":[],"examples":[{"text":"unu ffa-gama=a dondon dondon aparagi-midum-mas-i-i sudac-i-i","trans":"ãã®å­ä¾›ã¯ã©ã‚“ã©ã‚“ã©ã‚“ã©ã‚“ç¾ã—ã„å¥³ã«è‚²ã£ã¦","morphs":["unu","ffa","-gama","=a","dondon","dondon","aparagi","midum","-mas","-i","-i","sudac","-i","-i"],"glosses":["ãã®","å­","DIM","TOP","ONM","ONM","ç¾ã—ã„","å¥³","CVLZ","THM","SEQ","è‚²ã¤","THM","SEQ"],"pos_list":["ADN","N","NAFX","ISP","INTJ","INTJ","ADJ","N","XAFX","VAFX","VAFX","V","VAFX","VAFX"],"target_index":9,"audio_file":"https://zenodo.org/api/records/17774723/files/003_unu_ffa-gamaa_dondon_dondon_a.wav/content?download=1","start_time":0,"end_time":0},{"text":"mura=kara=mai icban aparagi-munu=n mmja uu-fÉ¨ nar-i-i nar-i-u-tar=ca","trans":"æ‘ã§ã‚‚ä¸€ç•ªã®ç¾äººã«æˆé•·ã—ãŸã‚“ã ã¨ã•ã€‚","morphs":["mura","=kara","=mai","icban","aparagi","-munu","=n","mmja","uu","-fÉ¨","nar","-i","-i","nar","-i","-u","-tar","=ca"],"glosses":["æ‘","ABL","ADD","ä¸€ç•ª","ç¾ã—ã„","ADJ","DAT","DSC","å¤§ãã„","VLZ","ãªã‚‹","THM","SEQ","ãªã‚‹","THM","PROG","PST","HS"],"pos_list":["N","CP","LP","ADV","ADJ","AAFX","CP","INTJ","ADJ","AAFX","V","VAFX","VAFX","V","VAFX","AUX","VAFX","SFP"],"target_index":11,"audio_file":"https://zenodo.org/api/records/17774723/files/004_murakaramai_icban_aparagi-mu.wav/content?download=1","start_time":0,"end_time":0}],"morph_index":2},{"morph":"-i","pos":"VAFX","gloss":"SEQ","allomorphs":[],"examples":[{"text":"unu ffa-gama=a dondon dondon aparagi-midum-mas-i-i sudac-i-i","trans":"ãã®å­ä¾›ã¯ã©ã‚“ã©ã‚“ã©ã‚“ã©ã‚“ç¾ã—ã„å¥³ã«è‚²ã£ã¦","morphs":["unu","ffa","-gama","=a","dondon","dondon","aparagi","midum","-mas","-i","-i","sudac","-i","-i"],"glosses":["ãã®","å­","DIM","TOP","ONM","ONM","ç¾ã—ã„","å¥³","CVLZ","THM","SEQ","è‚²ã¤","THM","SEQ"],"pos_list":["ADN","N","NAFX","ISP","INTJ","INTJ","ADJ","N","XAFX","VAFX","VAFX","V","VAFX","VAFX"],"target_index":10,"audio_file":"https://zenodo.org/api/records/17774723/files/003_unu_ffa-gamaa_dondon_dondon_a.wav/content?download=1","start_time":0,"end_time":0},{"text":"mura=kara=mai icban aparagi-munu=n mmja uu-fÉ¨ nar-i-i nar-i-u-tar=ca","trans":"æ‘ã§ã‚‚ä¸€ç•ªã®ç¾äººã«æˆé•·ã—ãŸã‚“ã ã¨ã•ã€‚","morphs":["mura","=kara","=mai","icban","aparagi","-munu","=n","mmja","uu","-fÉ¨","nar","-i","-i","nar","-i","-u","-tar","=ca"],"glosses":["æ‘","ABL","ADD","ä¸€ç•ª","ç¾ã—ã„","ADJ","DAT","DSC","å¤§ãã„","VLZ","ãªã‚‹","THM","SEQ","ãªã‚‹","THM","PROG","PST","HS"],"pos_list":["N","CP","LP","ADV","ADJ","AAFX","CP","INTJ","ADJ","AAFX","V","VAFX","VAFX","V","VAFX","AUX","VAFX","SFP"],"target_index":12,"audio_file":"https://zenodo.org/api/records/17774723/files/004_murakaramai_icban_aparagi-mu.wav/content?download=1","start_time":0,"end_time":0}],"morph_index":1},{"morph":"-mas","pos":"XAFX","gloss":"CVLZ","allomorphs":[],"examples":[{"text":"unu ffa-gama=a dondon dondon aparagi-midum-mas-i-i sudac-i-i","trans":"ãã®å­ä¾›ã¯ã©ã‚“ã©ã‚“ã©ã‚“ã©ã‚“ç¾ã—ã„å¥³ã«è‚²ã£ã¦","morphs":["unu","ffa","-gama","=a","dondon","dondon","aparagi","midum","-mas","-i","-i","sudac","-i","-i"],"glosses":["ãã®","å­","DIM","TOP","ONM","ONM","ç¾ã—ã„","å¥³","CVLZ","THM","SEQ","è‚²ã¤","THM","SEQ"],"pos_list":["ADN","N","NAFX","ISP","INTJ","INTJ","ADJ","N","XAFX","VAFX","VAFX","V","VAFX","VAFX"],"target_index":8,"audio_file":"https://zenodo.org/api/records/17774723/files/003_unu_ffa-gamaa_dondon_dondon_a.wav/content?download=1","start_time":0,"end_time":0}],"morph_index":null},{"morph":"-munu","pos":"AAFX","gloss":"ADJ","allomorphs":[],"examples":[{"text":"mura=kara=mai icban aparagi-munu=n mmja uu-fÉ¨ nar-i-i nar-i-u-tar=ca","trans":"æ‘ã§ã‚‚ä¸€ç•ªã®ç¾äººã«æˆé•·ã—ãŸã‚“ã ã¨ã•ã€‚","morphs":["mura","=kara","=mai","icban","aparagi","-munu","=n","mmja","uu","-fÉ¨","nar","-i","-i","nar","-i","-u","-tar","=ca"],"glosses":["æ‘","ABL","ADD","ä¸€ç•ª","ç¾ã—ã„","ADJ","DAT","DSC","å¤§ãã„","VLZ","ãªã‚‹","THM","SEQ","ãªã‚‹","THM","PROG","PST","HS"],"pos_list":["N","CP","LP","ADV","ADJ","AAFX","CP","INTJ","ADJ","AAFX","V","VAFX","VAFX","V","VAFX","AUX","VAFX","SFP"],"target_index":5,"audio_file":"https://zenodo.org/api/records/17774723/files/004_murakaramai_icban_aparagi-mu.wav/content?download=1","start_time":0,"end_time":0}],"morph_index":null},{"morph":"-tar","pos":"VAFX","gloss":"PST","allomorphs":[],"examples":[{"text":"nkjaan=du anna=tu uja=tu tamamiga=ti asÉ¨ ffa-gama=nu u-tar=ca","trans":"æ˜”ã€…ã€æ¯è¦ªã¨çˆ¶è¦ªã¨ã‚¿ãƒãƒŸã‚¬ã¨ã„ã†å­ä¾›ãŒã„ãŸã‚“ã ã¨ã•ã€‚","morphs":["nkjaan","=du","anna","=tu","uja","=tu","tamamiga","=ti","asÉ¨","ffa","-gama","=nu","u","-tar","=ca"],"glosses":["æ˜”","FOC","æ¯è¦ª","COM","çˆ¶è¦ª","COM","ã‚¿ãƒãƒŸã‚¬","QUOT","è¨€ã†","å­","DIM","NOM","ã„ã‚‹","PST","HS"],"pos_list":["N","ISP","N","CP","N","CP","N","CJP","V","N","NAFX","CP","V","VAFX","SFP"],"target_index":13,"audio_file":"https://zenodo.org/api/records/17774723/files/002_nkjaandu_annatu_ujatu_tamam.wav/content?download=1","start_time":0,"end_time":0},{"text":"mura=kara=mai icban aparagi-munu=n mmja uu-fÉ¨ nar-i-i nar-i-u-tar=ca","trans":"æ‘ã§ã‚‚ä¸€ç•ªã®ç¾äººã«æˆé•·ã—ãŸã‚“ã ã¨ã•ã€‚","morphs":["mura","=kara","=mai","icban","aparagi","-munu","=n","mmja","uu","-fÉ¨","nar","-i","-i","nar","-i","-u","-tar","=ca"],"glosses":["æ‘","ABL","ADD","ä¸€ç•ª","ç¾ã—ã„","ADJ","DAT","DSC","å¤§ãã„","VLZ","ãªã‚‹","THM","SEQ","ãªã‚‹","THM","PROG","PST","HS"],"pos_list":["N","CP","LP","ADV","ADJ","AAFX","CP","INTJ","ADJ","AAFX","V","VAFX","VAFX","V","VAFX","AUX","VAFX","SFP"],"target_index":16,"audio_file":"https://zenodo.org/api/records/17774723/files/004_murakaramai_icban_aparagi-mu.wav/content?download=1","start_time":0,"end_time":0}],"morph_index":null},{"morph":"-u","pos":"AUX","gloss":"PROG","allomorphs":[],"examples":[{"text":"mura=kara=mai icban aparagi-munu=n mmja uu-fÉ¨ nar-i-i nar-i-u-tar=ca","trans":"æ‘ã§ã‚‚ä¸€ç•ªã®ç¾äººã«æˆé•·ã—ãŸã‚“ã ã¨ã•ã€‚","morphs":["mura","=kara","=mai","icban","aparagi","-munu","=n","mmja","uu","-fÉ¨","nar","-i","-i","nar","-i","-u","-tar","=ca"],"glosses":["æ‘","ABL","ADD","ä¸€ç•ª","ç¾ã—ã„","ADJ","DAT","DSC","å¤§ãã„","VLZ","ãªã‚‹","THM","SEQ","ãªã‚‹","THM","PROG","PST","HS"],"pos_list":["N","CP","LP","ADV","ADJ","AAFX","CP","INTJ","ADJ","AAFX","V","VAFX","VAFX","V","VAFX","AUX","VAFX","SFP"],"target_index":15,"audio_file":"https://zenodo.org/api/records/17774723/files/004_murakaramai_icban_aparagi-mu.wav/content?download=1","start_time":0,"end_time":0}],"morph_index":null},{"morph":"=a","pos":"ISP","gloss":"TOP","allomorphs":[],"examples":[{"text":"unu ffa-gama=a dondon dondon aparagi-midum-mas-i-i sudac-i-i","trans":"ãã®å­ä¾›ã¯ã©ã‚“ã©ã‚“ã©ã‚“ã©ã‚“ç¾ã—ã„å¥³ã«è‚²ã£ã¦","morphs":["unu","ffa","-gama","=a","dondon","dondon","aparagi","midum","-mas","-i","-i","sudac","-i","-i"],"glosses":["ãã®","å­","DIM","TOP","ONM","ONM","ç¾ã—ã„","å¥³","CVLZ","THM","SEQ","è‚²ã¤","THM","SEQ"],"pos_list":["ADN","N","NAFX","ISP","INTJ","INTJ","ADJ","N","XAFX","VAFX","VAFX","V","VAFX","VAFX"],"target_index":3,"audio_file":"https://zenodo.org/api/records/17774723/files/003_unu_ffa-gamaa_dondon_dondon_a.wav/content?download=1","start_time":0,"end_time":0}],"morph_index":null},{"morph":"=ca","pos":"SFP","gloss":"HS","allomorphs":[],"examples":[{"text":"nkjaan=ca","trans":"æ˜”ã€…ã®ã“ã¨ã ã¨ã•ã€‚","morphs":["nkjaan","=ca"],"glosses":["æ˜”","HS"],"pos_list":["N","SFP"],"target_index":1,"audio_file":"https://zenodo.org/api/records/17774723/files/001_nkjaanca.wav/content?download=1","start_time":0,"end_time":0},{"text":"nkjaan=du anna=tu uja=tu tamamiga=ti asÉ¨ ffa-gama=nu u-tar=ca","trans":"æ˜”ã€…ã€æ¯è¦ªã¨çˆ¶è¦ªã¨ã‚¿ãƒãƒŸã‚¬ã¨ã„ã†å­ä¾›ãŒã„ãŸã‚“ã ã¨ã•ã€‚","morphs":["nkjaan","=du","anna","=tu","uja","=tu","tamamiga","=ti","asÉ¨","ffa","-gama","=nu","u","-tar","=ca"],"glosses":["æ˜”","FOC","æ¯è¦ª","COM","çˆ¶è¦ª","COM","ã‚¿ãƒãƒŸã‚¬","QUOT","è¨€ã†","å­","DIM","NOM","ã„ã‚‹","PST","HS"],"pos_list":["N","ISP","N","CP","N","CP","N","CJP","V","N","NAFX","CP","V","VAFX","SFP"],"target_index":14,"audio_file":"https://zenodo.org/api/records/17774723/files/002_nkjaandu_annatu_ujatu_tamam.wav/content?download=1","start_time":0,"end_time":0},{"text":"mura=kara=mai icban aparagi-munu=n mmja uu-fÉ¨ nar-i-i nar-i-u-tar=ca","trans":"æ‘ã§ã‚‚ä¸€ç•ªã®ç¾äººã«æˆé•·ã—ãŸã‚“ã ã¨ã•ã€‚","morphs":["mura","=kara","=mai","icban","aparagi","-munu","=n","mmja","uu","-fÉ¨","nar","-i","-i","nar","-i","-u","-tar","=ca"],"glosses":["æ‘","ABL","ADD","ä¸€ç•ª","ç¾ã—ã„","ADJ","DAT","DSC","å¤§ãã„","VLZ","ãªã‚‹","THM","SEQ","ãªã‚‹","THM","PROG","PST","HS"],"pos_list":["N","CP","LP","ADV","ADJ","AAFX","CP","INTJ","ADJ","AAFX","V","VAFX","VAFX","V","VAFX","AUX","VAFX","SFP"],"target_index":17,"audio_file":"https://zenodo.org/api/records/17774723/files/004_murakaramai_icban_aparagi-mu.wav/content?download=1","start_time":0,"end_time":0}],"morph_index":null},{"morph":"=du","pos":"ISP","gloss":"FOC","allomorphs":[],"examples":[{"text":"nkjaan=du anna=tu uja=tu tamamiga=ti asÉ¨ ffa-gama=nu u-tar=ca","trans":"æ˜”ã€…ã€æ¯è¦ªã¨çˆ¶è¦ªã¨ã‚¿ãƒãƒŸã‚¬ã¨ã„ã†å­ä¾›ãŒã„ãŸã‚“ã ã¨ã•ã€‚","morphs":["nkjaan","=du","anna","=tu","uja","=tu","tamamiga","=ti","asÉ¨","ffa","-gama","=nu","u","-tar","=ca"],"glosses":["æ˜”","FOC","æ¯è¦ª","COM","çˆ¶è¦ª","COM","ã‚¿ãƒãƒŸã‚¬","QUOT","è¨€ã†","å­","DIM","NOM","ã„ã‚‹","PST","HS"],"pos_list":["N","ISP","N","CP","N","CP","N","CJP","V","N","NAFX","CP","V","VAFX","SFP"],"target_index":1,"audio_file":"https://zenodo.org/api/records/17774723/files/002_nkjaandu_annatu_ujatu_tamam.wav/content?download=1","start_time":0,"end_time":0}],"morph_index":null},{"morph":"=kara","pos":"CP","gloss":"ABL","allomorphs":[],"examples":[{"text":"mura=kara=mai icban aparagi-munu=n mmja uu-fÉ¨ nar-i-i nar-i-u-tar=ca","trans":"æ‘ã§ã‚‚ä¸€ç•ªã®ç¾äººã«æˆé•·ã—ãŸã‚“ã ã¨ã•ã€‚","morphs":["mura","=kara","=mai","icban","aparagi","-munu","=n","mmja","uu","-fÉ¨","nar","-i","-i","nar","-i","-u","-tar","=ca"],"glosses":["æ‘","ABL","ADD","ä¸€ç•ª","ç¾ã—ã„","ADJ","DAT","DSC","å¤§ãã„","VLZ","ãªã‚‹","THM","SEQ","ãªã‚‹","THM","PROG","PST","HS"],"pos_list":["N","CP","LP","ADV","ADJ","AAFX","CP","INTJ","ADJ","AAFX","V","VAFX","VAFX","V","VAFX","AUX","VAFX","SFP"],"target_index":1,"audio_file":"https://zenodo.org/api/records/17774723/files/004_murakaramai_icban_aparagi-mu.wav/content?download=1","start_time":0,"end_time":0}],"morph_index":null},{"morph":"=mai","pos":"LP","gloss":"ADD","allomorphs":[],"examples":[{"text":"mura=kara=mai icban aparagi-munu=n mmja uu-fÉ¨ nar-i-i nar-i-u-tar=ca","trans":"æ‘ã§ã‚‚ä¸€ç•ªã®ç¾äººã«æˆé•·ã—ãŸã‚“ã ã¨ã•ã€‚","morphs":["mura","=kara","=mai","icban","aparagi","-munu","=n","mmja","uu","-fÉ¨","nar","-i","-i","nar","-i","-u","-tar","=ca"],"glosses":["æ‘","ABL","ADD","ä¸€ç•ª","ç¾ã—ã„","ADJ","DAT","DSC","å¤§ãã„","VLZ","ãªã‚‹","THM","SEQ","ãªã‚‹","THM","PROG","PST","HS"],"pos_list":["N","CP","LP","ADV","ADJ","AAFX","CP","INTJ","ADJ","AAFX","V","VAFX","VAFX","V","VAFX","AUX","VAFX","SFP"],"target_index":2,"audio_file":"https://zenodo.org/api/records/17774723/files/004_murakaramai_icban_aparagi-mu.wav/content?download=1","start_time":0,"end_time":0}],"morph_index":null},{"morph":"=n","pos":"CP","gloss":"DAT","allomorphs":[],"examples":[{"text":"mura=kara=mai icban aparagi-munu=n mmja uu-fÉ¨ nar-i-i nar-i-u-tar=ca","trans":"æ‘ã§ã‚‚ä¸€ç•ªã®ç¾äººã«æˆé•·ã—ãŸã‚“ã ã¨ã•ã€‚","morphs":["mura","=kara","=mai","icban","aparagi","-munu","=n","mmja","uu","-fÉ¨","nar","-i","-i","nar","-i","-u","-tar","=ca"],"glosses":["æ‘","ABL","ADD","ä¸€ç•ª","ç¾ã—ã„","ADJ","DAT","DSC","å¤§ãã„","VLZ","ãªã‚‹","THM","SEQ","ãªã‚‹","THM","PROG","PST","HS"],"pos_list":["N","CP","LP","ADV","ADJ","AAFX","CP","INTJ","ADJ","AAFX","V","VAFX","VAFX","V","VAFX","AUX","VAFX","SFP"],"target_index":6,"audio_file":"https://zenodo.org/api/records/17774723/files/004_murakaramai_icban_aparagi-mu.wav/content?download=1","start_time":0,"end_time":0}],"morph_index":null},{"morph":"=nu","pos":"CP","gloss":"NOM","allomorphs":[],"examples":[{"text":"nkjaan=du anna=tu uja=tu tamamiga=ti asÉ¨ ffa-gama=nu u-tar=ca","trans":"æ˜”ã€…ã€æ¯è¦ªã¨çˆ¶è¦ªã¨ã‚¿ãƒãƒŸã‚¬ã¨ã„ã†å­ä¾›ãŒã„ãŸã‚“ã ã¨ã•ã€‚","morphs":["nkjaan","=du","anna","=tu","uja","=tu","tamamiga","=ti","asÉ¨","ffa","-gama","=nu","u","-tar","=ca"],"glosses":["æ˜”","FOC","æ¯è¦ª","COM","çˆ¶è¦ª","COM","ã‚¿ãƒãƒŸã‚¬","QUOT","è¨€ã†","å­","DIM","NOM","ã„ã‚‹","PST","HS"],"pos_list":["N","ISP","N","CP","N","CP","N","CJP","V","N","NAFX","CP","V","VAFX","SFP"],"target_index":11,"audio_file":"https://zenodo.org/api/records/17774723/files/002_nkjaandu_annatu_ujatu_tamam.wav/content?download=1","start_time":0,"end_time":0}],"morph_index":null},{"morph":"=ti","pos":"CJP","gloss":"QUOT","allomorphs":[],"examples":[{"text":"nkjaan=du anna=tu uja=tu tamamiga=ti asÉ¨ ffa-gama=nu u-tar=ca","trans":"æ˜”ã€…ã€æ¯è¦ªã¨çˆ¶è¦ªã¨ã‚¿ãƒãƒŸã‚¬ã¨ã„ã†å­ä¾›ãŒã„ãŸã‚“ã ã¨ã•ã€‚","morphs":["nkjaan","=du","anna","=tu","uja","=tu","tamamiga","=ti","asÉ¨","ffa","-gama","=nu","u","-tar","=ca"],"glosses":["æ˜”","FOC","æ¯è¦ª","COM","çˆ¶è¦ª","COM","ã‚¿ãƒãƒŸã‚¬","QUOT","è¨€ã†","å­","DIM","NOM","ã„ã‚‹","PST","HS"],"pos_list":["N","ISP","N","CP","N","CP","N","CJP","V","N","NAFX","CP","V","VAFX","SFP"],"target_index":7,"audio_file":"https://zenodo.org/api/records/17774723/files/002_nkjaandu_annatu_ujatu_tamam.wav/content?download=1","start_time":0,"end_time":0}],"morph_index":null},{"morph":"=tu","pos":"CP","gloss":"COM","allomorphs":[],"examples":[{"text":"nkjaan=du anna=tu uja=tu tamamiga=ti asÉ¨ ffa-gama=nu u-tar=ca","trans":"æ˜”ã€…ã€æ¯è¦ªã¨çˆ¶è¦ªã¨ã‚¿ãƒãƒŸã‚¬ã¨ã„ã†å­ä¾›ãŒã„ãŸã‚“ã ã¨ã•ã€‚","morphs":["nkjaan","=du","anna","=tu","uja","=tu","tamamiga","=ti","asÉ¨","ffa","-gama","=nu","u","-tar","=ca"],"glosses":["æ˜”","FOC","æ¯è¦ª","COM","çˆ¶è¦ª","COM","ã‚¿ãƒãƒŸã‚¬","QUOT","è¨€ã†","å­","DIM","NOM","ã„ã‚‹","PST","HS"],"pos_list":["N","ISP","N","CP","N","CP","N","CJP","V","N","NAFX","CP","V","VAFX","SFP"],"target_index":3,"audio_file":"https://zenodo.org/api/records/17774723/files/002_nkjaandu_annatu_ujatu_tamam.wav/content?download=1","start_time":0,"end_time":0}],"morph_index":null},{"morph":"anna","pos":"N","gloss":"æ¯è¦ª","allomorphs":[],"examples":[{"text":"nkjaan=du anna=tu uja=tu tamamiga=ti asÉ¨ ffa-gama=nu u-tar=ca","trans":"æ˜”ã€…ã€æ¯è¦ªã¨çˆ¶è¦ªã¨ã‚¿ãƒãƒŸã‚¬ã¨ã„ã†å­ä¾›ãŒã„ãŸã‚“ã ã¨ã•ã€‚","morphs":["nkjaan","=du","anna","=tu","uja","=tu","tamamiga","=ti","asÉ¨","ffa","-gama","=nu","u","-tar","=ca"],"glosses":["æ˜”","FOC","æ¯è¦ª","COM","çˆ¶è¦ª","COM","ã‚¿ãƒãƒŸã‚¬","QUOT","è¨€ã†","å­","DIM","NOM","ã„ã‚‹","PST","HS"],"pos_list":["N","ISP","N","CP","N","CP","N","CJP","V","N","NAFX","CP","V","VAFX","SFP"],"target_index":2,"audio_file":"https://zenodo.org/api/records/17774723/files/002_nkjaandu_annatu_ujatu_tamam.wav/content?download=1","start_time":0,"end_time":0}],"morph_index":null},{"morph":"aparagi","pos":"ADJ","gloss":"ç¾ã—ã„","allomorphs":[],"examples":[{"text":"unu ffa-gama=a dondon dondon aparagi-midum-mas-i-i sudac-i-i","trans":"ãã®å­ä¾›ã¯ã©ã‚“ã©ã‚“ã©ã‚“ã©ã‚“ç¾ã—ã„å¥³ã«è‚²ã£ã¦","morphs":["unu","ffa","-gama","=a","dondon","dondon","aparagi","midum","-mas","-i","-i","sudac","-i","-i"],"glosses":["ãã®","å­","DIM","TOP","ONM","ONM","ç¾ã—ã„","å¥³","CVLZ","THM","SEQ","è‚²ã¤","THM","SEQ"],"pos_list":["ADN","N","NAFX","ISP","INTJ","INTJ","ADJ","N","XAFX","VAFX","VAFX","V","VAFX","VAFX"],"target_index":6,"audio_file":"https://zenodo.org/api/records/17774723/files/003_unu_ffa-gamaa_dondon_dondon_a.wav/content?download=1","start_time":0,"end_time":0},{"text":"mura=kara=mai icban aparagi-munu=n mmja uu-fÉ¨ nar-i-i nar-i-u-tar=ca","trans":"æ‘ã§ã‚‚ä¸€ç•ªã®ç¾äººã«æˆé•·ã—ãŸã‚“ã ã¨ã•ã€‚","morphs":["mura","=kara","=mai","icban","aparagi","-munu","=n","mmja","uu","-fÉ¨","nar","-i","-i","nar","-i","-u","-tar","=ca"],"glosses":["æ‘","ABL","ADD","ä¸€ç•ª","ç¾ã—ã„","ADJ","DAT","DSC","å¤§ãã„","VLZ","ãªã‚‹","THM","SEQ","ãªã‚‹","THM","PROG","PST","HS"],"pos_list":["N","CP","LP","ADV","ADJ","AAFX","CP","INTJ","ADJ","AAFX","V","VAFX","VAFX","V","VAFX","AUX","VAFX","SFP"],"target_index":4,"audio_file":"https://zenodo.org/api/records/17774723/files/004_murakaramai_icban_aparagi-mu.wav/content?download=1","start_time":0,"end_time":0}],"morph_index":null},{"morph":"asÉ¨","pos":"V","gloss":"è¨€ã†","allomorphs":[],"examples":[{"text":"nkjaan=du anna=tu uja=tu tamamiga=ti asÉ¨ ffa-gama=nu u-tar=ca","trans":"æ˜”ã€…ã€æ¯è¦ªã¨çˆ¶è¦ªã¨ã‚¿ãƒãƒŸã‚¬ã¨ã„ã†å­ä¾›ãŒã„ãŸã‚“ã ã¨ã•ã€‚","morphs":["nkjaan","=du","anna","=tu","uja","=tu","tamamiga","=ti","asÉ¨","ffa","-gama","=nu","u","-tar","=ca"],"glosses":["æ˜”","FOC","æ¯è¦ª","COM","çˆ¶è¦ª","COM","ã‚¿ãƒãƒŸã‚¬","QUOT","è¨€ã†","å­","DIM","NOM","ã„ã‚‹","PST","HS"],"pos_list":["N","ISP","N","CP","N","CP","N","CJP","V","N","NAFX","CP","V","VAFX","SFP"],"target_index":8,"audio_file":"https://zenodo.org/api/records/17774723/files/002_nkjaandu_annatu_ujatu_tamam.wav/content?download=1","start_time":0,"end_time":0}],"morph_index":null},{"morph":"dondon","pos":"INTJ","gloss":"ONM","allomorphs":[],"examples":[{"text":"unu ffa-gama=a dondon dondon aparagi-midum-mas-i-i sudac-i-i","trans":"ãã®å­ä¾›ã¯ã©ã‚“ã©ã‚“ã©ã‚“ã©ã‚“ç¾ã—ã„å¥³ã«è‚²ã£ã¦","morphs":["unu","ffa","-gama","=a","dondon","dondon","aparagi","midum","-mas","-i","-i","sudac","-i","-i"],"glosses":["ãã®","å­","DIM","TOP","ONM","ONM","ç¾ã—ã„","å¥³","CVLZ","THM","SEQ","è‚²ã¤","THM","SEQ"],"pos_list":["ADN","N","NAFX","ISP","INTJ","INTJ","ADJ","N","XAFX","VAFX","VAFX","V","VAFX","VAFX"],"target_index":4,"audio_file":"https://zenodo.org/api/records/17774723/files/003_unu_ffa-gamaa_dondon_dondon_a.wav/content?download=1","start_time":0,"end_time":0}],"morph_index":null},{"morph":"ffa","pos":"N","gloss":"å­","allomorphs":[],"examples":[{"text":"nkjaan=du anna=tu uja=tu tamamiga=ti asÉ¨ ffa-gama=nu u-tar=ca","trans":"æ˜”ã€…ã€æ¯è¦ªã¨çˆ¶è¦ªã¨ã‚¿ãƒãƒŸã‚¬ã¨ã„ã†å­ä¾›ãŒã„ãŸã‚“ã ã¨ã•ã€‚","morphs":["nkjaan","=du","anna","=tu","uja","=tu","tamamiga","=ti","asÉ¨","ffa","-gama","=nu","u","-tar","=ca"],"glosses":["æ˜”","FOC","æ¯è¦ª","COM","çˆ¶è¦ª","COM","ã‚¿ãƒãƒŸã‚¬","QUOT","è¨€ã†","å­","DIM","NOM","ã„ã‚‹","PST","HS"],"pos_list":["N","ISP","N","CP","N","CP","N","CJP","V","N","NAFX","CP","V","VAFX","SFP"],"target_index":9,"audio_file":"https://zenodo.org/api/records/17774723/files/002_nkjaandu_annatu_ujatu_tamam.wav/content?download=1","start_time":0,"end_time":0},{"text":"unu ffa-gama=a dondon dondon aparagi-midum-mas-i-i sudac-i-i","trans":"ãã®å­ä¾›ã¯ã©ã‚“ã©ã‚“ã©ã‚“ã©ã‚“ç¾ã—ã„å¥³ã«è‚²ã£ã¦","morphs":["unu","ffa","-gama","=a","dondon","dondon","aparagi","midum","-mas","-i","-i","sudac","-i","-i"],"glosses":["ãã®","å­","DIM","TOP","ONM","ONM","ç¾ã—ã„","å¥³","CVLZ","THM","SEQ","è‚²ã¤","THM","SEQ"],"pos_list":["ADN","N","NAFX","ISP","INTJ","INTJ","ADJ","N","XAFX","VAFX","VAFX","V","VAFX","VAFX"],"target_index":1,"audio_file":"https://zenodo.org/api/records/17774723/files/003_unu_ffa-gamaa_dondon_dondon_a.wav/content?download=1","start_time":0,"end_time":0}],"morph_index":null},{"morph":"icban","pos":"ADV","gloss":"ä¸€ç•ª","allomorphs":[],"examples":[{"text":"mura=kara=mai icban aparagi-munu=n mmja uu-fÉ¨ nar-i-i nar-i-u-tar=ca","trans":"æ‘ã§ã‚‚ä¸€ç•ªã®ç¾äººã«æˆé•·ã—ãŸã‚“ã ã¨ã•ã€‚","morphs":["mura","=kara","=mai","icban","aparagi","-munu","=n","mmja","uu","-fÉ¨","nar","-i","-i","nar","-i","-u","-tar","=ca"],"glosses":["æ‘","ABL","ADD","ä¸€ç•ª","ç¾ã—ã„","ADJ","DAT","DSC","å¤§ãã„","VLZ","ãªã‚‹","THM","SEQ","ãªã‚‹","THM","PROG","PST","HS"],"pos_list":["N","CP","LP","ADV","ADJ","AAFX","CP","INTJ","ADJ","AAFX","V","VAFX","VAFX","V","VAFX","AUX","VAFX","SFP"],"target_index":3,"audio_file":"https://zenodo.org/api/records/17774723/files/004_murakaramai_icban_aparagi-mu.wav/content?download=1","start_time":0,"end_time":0}],"morph_index":null},{"morph":"midum","pos":"N","gloss":"å¥³","allomorphs":[],"examples":[{"text":"unu ffa-gama=a dondon dondon aparagi-midum-mas-i-i sudac-i-i","trans":"ãã®å­ä¾›ã¯ã©ã‚“ã©ã‚“ã©ã‚“ã©ã‚“ç¾ã—ã„å¥³ã«è‚²ã£ã¦","morphs":["unu","ffa","-gama","=a","dondon","dondon","aparagi","midum","-mas","-i","-i","sudac","-i","-i"],"glosses":["ãã®","å­","DIM","TOP","ONM","ONM","ç¾ã—ã„","å¥³","CVLZ","THM","SEQ","è‚²ã¤","THM","SEQ"],"pos_list":["ADN","N","NAFX","ISP","INTJ","INTJ","ADJ","N","XAFX","VAFX","VAFX","V","VAFX","VAFX"],"target_index":7,"audio_file":"https://zenodo.org/api/records/17774723/files/003_unu_ffa-gamaa_dondon_dondon_a.wav/content?download=1","start_time":0,"end_time":0}],"morph_index":null},{"morph":"mmja","pos":"INTJ","gloss":"DSC","allomorphs":[],"examples":[{"text":"mura=kara=mai icban aparagi-munu=n mmja uu-fÉ¨ nar-i-i nar-i-u-tar=ca","trans":"æ‘ã§ã‚‚ä¸€ç•ªã®ç¾äººã«æˆé•·ã—ãŸã‚“ã ã¨ã•ã€‚","morphs":["mura","=kara","=mai","icban","aparagi","-munu","=n","mmja","uu","-fÉ¨","nar","-i","-i","nar","-i","-u","-tar","=ca"],"glosses":["æ‘","ABL","ADD","ä¸€ç•ª","ç¾ã—ã„","ADJ","DAT","DSC","å¤§ãã„","VLZ","ãªã‚‹","THM","SEQ","ãªã‚‹","THM","PROG","PST","HS"],"pos_list":["N","CP","LP","ADV","ADJ","AAFX","CP","INTJ","ADJ","AAFX","V","VAFX","VAFX","V","VAFX","AUX","VAFX","SFP"],"target_index":7,"audio_file":"https://zenodo.org/api/records/17774723/files/004_murakaramai_icban_aparagi-mu.wav/content?download=1","start_time":0,"end_time":0}],"morph_index":null},{"morph":"mura","pos":"N","gloss":"æ‘","allomorphs":[],"examples":[{"text":"mura=kara=mai icban aparagi-munu=n mmja uu-fÉ¨ nar-i-i nar-i-u-tar=ca","trans":"æ‘ã§ã‚‚ä¸€ç•ªã®ç¾äººã«æˆé•·ã—ãŸã‚“ã ã¨ã•ã€‚","morphs":["mura","=kara","=mai","icban","aparagi","-munu","=n","mmja","uu","-fÉ¨","nar","-i","-i","nar","-i","-u","-tar","=ca"],"glosses":["æ‘","ABL","ADD","ä¸€ç•ª","ç¾ã—ã„","ADJ","DAT","DSC","å¤§ãã„","VLZ","ãªã‚‹","THM","SEQ","ãªã‚‹","THM","PROG","PST","HS"],"pos_list":["N","CP","LP","ADV","ADJ","AAFX","CP","INTJ","ADJ","AAFX","V","VAFX","VAFX","V","VAFX","AUX","VAFX","SFP"],"target_index":0,"audio_file":"https://zenodo.org/api/records/17774723/files/004_murakaramai_icban_aparagi-mu.wav/content?download=1","start_time":0,"end_time":0}],"morph_index":null},{"morph":"nar","pos":"V","gloss":"ãªã‚‹","allomorphs":[],"examples":[{"text":"mura=kara=mai icban aparagi-munu=n mmja uu-fÉ¨ nar-i-i nar-i-u-tar=ca","trans":"æ‘ã§ã‚‚ä¸€ç•ªã®ç¾äººã«æˆé•·ã—ãŸã‚“ã ã¨ã•ã€‚","morphs":["mura","=kara","=mai","icban","aparagi","-munu","=n","mmja","uu","-fÉ¨","nar","-i","-i","nar","-i","-u","-tar","=ca"],"glosses":["æ‘","ABL","ADD","ä¸€ç•ª","ç¾ã—ã„","ADJ","DAT","DSC","å¤§ãã„","VLZ","ãªã‚‹","THM","SEQ","ãªã‚‹","THM","PROG","PST","HS"],"pos_list":["N","CP","LP","ADV","ADJ","AAFX","CP","INTJ","ADJ","AAFX","V","VAFX","VAFX","V","VAFX","AUX","VAFX","SFP"],"target_index":10,"audio_file":"https://zenodo.org/api/records/17774723/files/004_murakaramai_icban_aparagi-mu.wav/content?download=1","start_time":0,"end_time":0}],"morph_index":null},{"morph":"nkjaan","pos":"N","gloss":"æ˜”","allomorphs":[],"examples":[{"text":"nkjaan=ca","trans":"æ˜”ã€…ã®ã“ã¨ã ã¨ã•ã€‚","morphs":["nkjaan","=ca"],"glosses":["æ˜”","HS"],"pos_list":["N","SFP"],"target_index":0,"audio_file":"https://zenodo.org/api/records/17774723/files/001_nkjaanca.wav/content?download=1","start_time":0,"end_time":0},{"text":"nkjaan=du anna=tu uja=tu tamamiga=ti asÉ¨ ffa-gama=nu u-tar=ca","trans":"æ˜”ã€…ã€æ¯è¦ªã¨çˆ¶è¦ªã¨ã‚¿ãƒãƒŸã‚¬ã¨ã„ã†å­ä¾›ãŒã„ãŸã‚“ã ã¨ã•ã€‚","morphs":["nkjaan","=du","anna","=tu","uja","=tu","tamamiga","=ti","asÉ¨","ffa","-gama","=nu","u","-tar","=ca"],"glosses":["æ˜”","FOC","æ¯è¦ª","COM","çˆ¶è¦ª","COM","ã‚¿ãƒãƒŸã‚¬","QUOT","è¨€ã†","å­","DIM","NOM","ã„ã‚‹","PST","HS"],"pos_list":["N","ISP","N","CP","N","CP","N","CJP","V","N","NAFX","CP","V","VAFX","SFP"],"target_index":0,"audio_file":"https://zenodo.org/api/records/17774723/files/002_nkjaandu_annatu_ujatu_tamam.wav/content?download=1","start_time":0,"end_time":0}],"morph_index":null},{"morph":"sudac","pos":"V","gloss":"è‚²ã¤","allomorphs":[],"examples":[{"text":"unu ffa-gama=a dondon dondon aparagi-midum-mas-i-i sudac-i-i","trans":"ãã®å­ä¾›ã¯ã©ã‚“ã©ã‚“ã©ã‚“ã©ã‚“ç¾ã—ã„å¥³ã«è‚²ã£ã¦","morphs":["unu","ffa","-gama","=a","dondon","dondon","aparagi","midum","-mas","-i","-i","sudac","-i","-i"],"glosses":["ãã®","å­","DIM","TOP","ONM","ONM","ç¾ã—ã„","å¥³","CVLZ","THM","SEQ","è‚²ã¤","THM","SEQ"],"pos_list":["ADN","N","NAFX","ISP","INTJ","INTJ","ADJ","N","XAFX","VAFX","VAFX","V","VAFX","VAFX"],"target_index":11,"audio_file":"https://zenodo.org/api/records/17774723/files/003_unu_ffa-gamaa_dondon_dondon_a.wav/content?download=1","start_time":0,"end_time":0}],"morph_index":null},{"morph":"tamamiga","pos":"N","gloss":"ã‚¿ãƒãƒŸã‚¬","allomorphs":[],"examples":[{"text":"nkjaan=du anna=tu uja=tu tamamiga=ti asÉ¨ ffa-gama=nu u-tar=ca","trans":"æ˜”ã€…ã€æ¯è¦ªã¨çˆ¶è¦ªã¨ã‚¿ãƒãƒŸã‚¬ã¨ã„ã†å­ä¾›ãŒã„ãŸã‚“ã ã¨ã•ã€‚","morphs":["nkjaan","=du","anna","=tu","uja","=tu","tamamiga","=ti","asÉ¨","ffa","-gama","=nu","u","-tar","=ca"],"glosses":["æ˜”","FOC","æ¯è¦ª","COM","çˆ¶è¦ª","COM","ã‚¿ãƒãƒŸã‚¬","QUOT","è¨€ã†","å­","DIM","NOM","ã„ã‚‹","PST","HS"],"pos_list":["N","ISP","N","CP","N","CP","N","CJP","V","N","NAFX","CP","V","VAFX","SFP"],"target_index":6,"audio_file":"https://zenodo.org/api/records/17774723/files/002_nkjaandu_annatu_ujatu_tamam.wav/content?download=1","start_time":0,"end_time":0}],"morph_index":null},{"morph":"u","pos":"V","gloss":"ã„ã‚‹","allomorphs":[],"examples":[{"text":"nkjaan=du anna=tu uja=tu tamamiga=ti asÉ¨ ffa-gama=nu u-tar=ca","trans":"æ˜”ã€…ã€æ¯è¦ªã¨çˆ¶è¦ªã¨ã‚¿ãƒãƒŸã‚¬ã¨ã„ã†å­ä¾›ãŒã„ãŸã‚“ã ã¨ã•ã€‚","morphs":["nkjaan","=du","anna","=tu","uja","=tu","tamamiga","=ti","asÉ¨","ffa","-gama","=nu","u","-tar","=ca"],"glosses":["æ˜”","FOC","æ¯è¦ª","COM","çˆ¶è¦ª","COM","ã‚¿ãƒãƒŸã‚¬","QUOT","è¨€ã†","å­","DIM","NOM","ã„ã‚‹","PST","HS"],"pos_list":["N","ISP","N","CP","N","CP","N","CJP","V","N","NAFX","CP","V","VAFX","SFP"],"target_index":12,"audio_file":"https://zenodo.org/api/records/17774723/files/002_nkjaandu_annatu_ujatu_tamam.wav/content?download=1","start_time":0,"end_time":0}],"morph_index":null},{"morph":"uja","pos":"N","gloss":"çˆ¶è¦ª","allomorphs":[],"examples":[{"text":"nkjaan=du anna=tu uja=tu tamamiga=ti asÉ¨ ffa-gama=nu u-tar=ca","trans":"æ˜”ã€…ã€æ¯è¦ªã¨çˆ¶è¦ªã¨ã‚¿ãƒãƒŸã‚¬ã¨ã„ã†å­ä¾›ãŒã„ãŸã‚“ã ã¨ã•ã€‚","morphs":["nkjaan","=du","anna","=tu","uja","=tu","tamamiga","=ti","asÉ¨","ffa","-gama","=nu","u","-tar","=ca"],"glosses":["æ˜”","FOC","æ¯è¦ª","COM","çˆ¶è¦ª","COM","ã‚¿ãƒãƒŸã‚¬","QUOT","è¨€ã†","å­","DIM","NOM","ã„ã‚‹","PST","HS"],"pos_list":["N","ISP","N","CP","N","CP","N","CJP","V","N","NAFX","CP","V","VAFX","SFP"],"target_index":4,"audio_file":"https://zenodo.org/api/records/17774723/files/002_nkjaandu_annatu_ujatu_tamam.wav/content?download=1","start_time":0,"end_time":0}],"morph_index":null},{"morph":"unu","pos":"ADN","gloss":"ãã®","allomorphs":[],"examples":[{"text":"unu ffa-gama=a dondon dondon aparagi-midum-mas-i-i sudac-i-i","trans":"ãã®å­ä¾›ã¯ã©ã‚“ã©ã‚“ã©ã‚“ã©ã‚“ç¾ã—ã„å¥³ã«è‚²ã£ã¦","morphs":["unu","ffa","-gama","=a","dondon","dondon","aparagi","midum","-mas","-i","-i","sudac","-i","-i"],"glosses":["ãã®","å­","DIM","TOP","ONM","ONM","ç¾ã—ã„","å¥³","CVLZ","THM","SEQ","è‚²ã¤","THM","SEQ"],"pos_list":["ADN","N","NAFX","ISP","INTJ","INTJ","ADJ","N","XAFX","VAFX","VAFX","V","VAFX","VAFX"],"target_index":0,"audio_file":"https://zenodo.org/api/records/17774723/files/003_unu_ffa-gamaa_dondon_dondon_a.wav/content?download=1","start_time":0,"end_time":0}],"morph_index":null},{"morph":"uu","pos":"ADJ","gloss":"å¤§ãã„","allomorphs":[],"examples":[{"text":"mura=kara=mai icban aparagi-munu=n mmja uu-fÉ¨ nar-i-i nar-i-u-tar=ca","trans":"æ‘ã§ã‚‚ä¸€ç•ªã®ç¾äººã«æˆé•·ã—ãŸã‚“ã ã¨ã•ã€‚","morphs":["mura","=kara","=mai","icban","aparagi","-munu","=n","mmja","uu","-fÉ¨","nar","-i","-i","nar","-i","-u","-tar","=ca"],"glosses":["æ‘","ABL","ADD","ä¸€ç•ª","ç¾ã—ã„","ADJ","DAT","DSC","å¤§ãã„","VLZ","ãªã‚‹","THM","SEQ","ãªã‚‹","THM","PROG","PST","HS"],"pos_list":["N","CP","LP","ADV","ADJ","AAFX","CP","INTJ","ADJ","AAFX","V","VAFX","VAFX","V","VAFX","AUX","VAFX","SFP"],"target_index":8,"audio_file":"https://zenodo.org/api/records/17774723/files/004_murakaramai_icban_aparagi-mu.wav/content?download=1","start_time":0,"end_time":0}],"morph_index":null}];
let currentFilter = null, currentLetter = null, searchQuery = '', reverseMode = false;
let searchMode = 'partial';
let searchTargets = { morph: true, gloss: true, pos: true, trans: true, allo: true };
let currentlyPlaying = null;

// éŸ³å£°ã‚’å†ç”Ÿ
async function playAudio(url, startTime, endTime, btn) {
    const audio = document.getElementById('mainAudio');
    
    // LaTeXã‚¹ã‚¿ã‚¤ãƒ«ã®UTFã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã‚’å¤‰æ›
    // ä¾‹: UTF{0268} â†’ É¨
    url = url.replace(/\UTF{([0-9A-Fa-f]+)}/g, (match, hex) => {
        return String.fromCodePoint(parseInt(hex, 16));
    });
    
    // æ—¢ã«å†ç”Ÿä¸­ã®å ´åˆã¯åœæ­¢
    if (currentlyPlaying && currentlyPlaying.button === btn && !audio.paused) {
        audio.pause();
        btn.classList.remove('playing');
        btn.textContent = 'â–¶';
        currentlyPlaying = null;
        return;
    }
    
    // å‰ã®å†ç”Ÿã‚’åœæ­¢
    if (currentlyPlaying) {
        audio.pause();
        if (currentlyPlaying.button) {
            currentlyPlaying.button.classList.remove('playing');
            currentlyPlaying.button.textContent = 'â–¶';
        }
    }
    
    btn.classList.add('playing');
    btn.textContent = 'â³';
    
    // ãƒ•ã‚¡ã‚¤ãƒ«å…¨ä½“ã‚’å†ç”Ÿã™ã‚‹ã‹ã€ç¯„å›²å†ç”Ÿã™ã‚‹ã‹ã‚’åˆ¤å®š
    const playFullFile = (!startTime && !endTime) || (startTime === 0 && endTime === 0);
    
    // å†ç”Ÿçµ‚äº†ãƒã‚§ãƒƒã‚¯ï¼ˆç¯„å›²å†ç”Ÿã®å ´åˆã®ã¿ï¼‰
    const checkEnd = () => {
        if (!playFullFile && audio.currentTime >= endTime) {
            audio.pause();
            btn.classList.remove('playing');
            btn.textContent = 'â–¶';
            currentlyPlaying = null;
        } else if (currentlyPlaying && currentlyPlaying.button === btn && !audio.paused) {
            requestAnimationFrame(checkEnd);
        }
    };
    
    // å†ç”Ÿçµ‚äº†ã‚¤ãƒ™ãƒ³ãƒˆï¼ˆãƒ•ã‚¡ã‚¤ãƒ«å…¨ä½“å†ç”Ÿã®å ´åˆï¼‰
    const onEnded = () => {
        btn.classList.remove('playing');
        btn.textContent = 'â–¶';
        currentlyPlaying = null;
        audio.removeEventListener('ended', onEnded);
    };
    
    // å†ç”Ÿé–‹å§‹
    const startPlay = async (finalUrl) => {
        audio.pause();
        audio.currentTime = 0;
        audio.src = finalUrl;
        
        if (playFullFile) {
            audio.addEventListener('ended', onEnded);
        }
        
        try {
            await audio.play();
            if (!playFullFile) {
                audio.currentTime = startTime;
                requestAnimationFrame(checkEnd);
            }
            btn.textContent = 'â¹';
            currentlyPlaying = { button: btn, endTime };
            return true;
        } catch (error) {
            console.log('Play failed:', error.name, error.message);
            audio.removeEventListener('ended', onEnded);
            return false;
        }
    };
    
    // ç›´æ¥URLã§è©¦ã™
    if (await startPlay(url)) return;
    
    // CORSãƒ—ãƒ­ã‚­ã‚·ã‚’è©¦ã™
    console.log('Trying CORS proxy...');
    if (await startPlay('https://corsproxy.io/?' + encodeURIComponent(url))) return;
    
    // åˆ¥ã®ãƒ—ãƒ­ã‚­ã‚·ã‚’è©¦ã™
    console.log('Trying alternative proxy...');
    if (await startPlay('https://api.allorigins.win/raw?url=' + encodeURIComponent(url))) return;
    
    // å…¨ã¦å¤±æ•—
    console.log('All attempts failed');
    btn.classList.remove('playing');
    btn.textContent = 'âŒ';
}

// ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿å¾Œã«ãƒ—ãƒªãƒ­ãƒ¼ãƒ‰é–‹å§‹
// éŸ³å£°ãƒ—ãƒªãƒ­ãƒ¼ãƒ‰ã¯å‰Šé™¤ï¼ˆã‚·ãƒ³ãƒ—ãƒ«ãªã‚¢ãƒ—ãƒ­ãƒ¼ãƒã«å¤‰æ›´ï¼‰

const glossReading = {'ä¸ŠãŒã‚‹':'ã‚ãŒã‚‹','é–“':'ã‚ã„ã ','å®¶':'ã„ãˆ','è¡Œã':'ã„ã','æµ·':'ã†ã¿','ãŠæ¯ã•ã‚“':'ãŠã‹ã‚ã•ã‚“','è½ã¡ã‚‹':'ãŠã¡ã‚‹','æ²–ç¸„':'ãŠããªã‚','é¡”':'ã‹ãŠ','å¸°ã‚‹':'ã‹ãˆã‚‹','è²·ã†':'ã‹ã†','ç¥':'ã‹ã¿','é«ª':'ã‹ã¿','æ¥ã‚‹':'ãã‚‹','é­š':'ã•ã‹ãª','æ­»ã¬':'ã—ã¬','æ‰‹':'ã¦','æ™‚':'ã¨ã','å‹é”':'ã¨ã‚‚ã ã¡','äºº':'ã²ã¨','èˆ¹':'ãµã­','æ˜”':'ã‚€ã‹ã—','æ°´':'ã¿ãš','ç‰©':'ã‚‚ã®','ç„¼ã':'ã‚„ã','è±†è…':'ã¨ã†ãµ','é£Ÿã¹ã‚‹':'ãŸã¹ã‚‹','å¤§ãã„':'ãŠãŠãã„','è²§ã—ã„':'ã¾ãšã—ã„','è±Šã‹ãª':'ã‚†ãŸã‹ãª'};
const gojuonRows = [{label:'ã‚',chars:'ã‚ã„ã†ãˆãŠã‚¢ã‚¤ã‚¦ã‚¨ã‚ª'},{label:'ã‹',chars:'ã‹ããã‘ã“ãŒããã’ã”ã‚«ã‚­ã‚¯ã‚±ã‚³ã‚¬ã‚®ã‚°ã‚²ã‚´'},{label:'ã•',chars:'ã•ã—ã™ã›ãã–ã˜ãšãœãã‚µã‚·ã‚¹ã‚»ã‚½ã‚¶ã‚¸ã‚ºã‚¼ã‚¾'},{label:'ãŸ',chars:'ãŸã¡ã¤ã¦ã¨ã ã¢ã¥ã§ã©ã‚¿ãƒãƒ„ãƒ†ãƒˆãƒ€ãƒ‚ãƒ…ãƒ‡ãƒ‰'},{label:'ãª',chars:'ãªã«ã¬ã­ã®ãƒŠãƒ‹ãƒŒãƒãƒ'},{label:'ã¯',chars:'ã¯ã²ãµã¸ã»ã°ã³ã¶ã¹ã¼ã±ã´ã·ãºã½ãƒãƒ’ãƒ•ãƒ˜ãƒ›ãƒãƒ“ãƒ–ãƒ™ãƒœãƒ‘ãƒ”ãƒ—ãƒšãƒ'},{label:'ã¾',chars:'ã¾ã¿ã‚€ã‚ã‚‚ãƒãƒŸãƒ ãƒ¡ãƒ¢'},{label:'ã‚„',chars:'ã‚„ã‚†ã‚ˆãƒ¤ãƒ¦ãƒ¨'},{label:'ã‚‰',chars:'ã‚‰ã‚Šã‚‹ã‚Œã‚ãƒ©ãƒªãƒ«ãƒ¬ãƒ­'},{label:'ã‚',chars:'ã‚ã‚’ã‚“ãƒ¯ãƒ²ãƒ³'},{label:'ä»–',chars:''}];

function getGojuonRow(str) { if (!str) return 'ä»–'; const r = glossReading[str], f = r ? r.charAt(0) : str.charAt(0); for (const row of gojuonRows) if (row.chars.includes(f)) return row.label; return 'ä»–'; }
function getGojuonSortKey(str) { if (!str) return 'ã‚“999'; if (glossReading[str]) return glossReading[str]; const first = str.charAt(0); if ((first >= 'ã' && first <= 'ã‚“') || (first >= 'ã‚¡' && first <= 'ãƒ³')) return str; return 'ã‚“999' + str; }
function getPosClass(pos) { const known = ['V','N','AUX','ADJ','ADV','PRN','CONJ','CP','ISP','SFP','INTJ','VAFX','NAFX','FN','PN','NUM','CLF','CJP','LP']; return known.includes(pos) ? 'pos-'+pos : 'pos-default'; }
function highlightText(text, q) { 
    if (!q || !text) return text || ''; 
    try { 
        const lower = text.toLowerCase();
        const qLower = q.toLowerCase();
        const idx = lower.indexOf(qLower);
        if (idx === -1) return text;
        return text.substring(0, idx) + '<span class="highlight">' + text.substring(idx, idx + q.length) + '</span>' + text.substring(idx + q.length);
    } catch(e) { return text; } 
}

function renderExample(ex) {
    const { morphs = [], glosses = [], trans, target_index, audio_file, start_time, end_time } = ex;
    const safeAudioFile = audio_file ? audio_file.replace(/'/g, "\\'") : '';
    let playBtn = audio_file ? `<button class="play-btn" onclick="playAudio('${safeAudioFile}', ${start_time || 0}, ${end_time || 0}, this)">â–¶</button>` : '';
    const transHtml = trans ? `<div class="example-trans">${trans}</div>` : '';
    let interlinear = '';
    for (let i = 0; i < morphs.length && i < glosses.length; i++) {
        const m = morphs[i], g = glosses[i]; if (!m || m === 'XXX') continue;
        interlinear += `<div class="gloss-unit ${i === target_index ? 'target' : ''}"><span class="morph-text">${m}</span><span class="gloss-text">${g}</span></div>`;
    }
    return `<div class="example"><div class="example-header">${playBtn}<div class="example-text">${ex.text}</div></div>${transHtml}<div class="interlinear">${interlinear}</div></div>`;
}

function renderEntry(item, q) {
    const posClass = getPosClass(item.pos), indexHtml = item.morph_index ? `<span class="morph-index">${item.morph_index}</span>` : '';
    const headerClass = reverseMode ? 'entry-header reverse' : 'entry-header';
    const glossDisplay = reverseMode && item.glosses_all?.length > 1 ? item.glosses_all.join('ã€') : item.gloss;
    let allomorphsHtml = item.allomorphs?.length ? `<div class="allomorphs">${item.allomorphs.map(a => `<span class="allomorph-item">${a}</span>`).join('')}</div>` : '';
    let examplesHtml = '';
    if (item.examples?.length) {
        const tc = item.examples.filter(e => e.trans).length, ac = item.examples.filter(e => e.audio_file).length;
        examplesHtml = `<div class="examples-section"><div class="examples-title">ğŸ“– ç”¨ä¾‹ ${item.examples.length}ä»¶${tc ? `ï¼ˆå’Œè¨³${tc}ä»¶ï¼‰` : ''}${ac ? ` ğŸ”Š${ac}ä»¶` : ''}</div>${item.examples.map(renderExample).join('')}</div>`;
    }
    return `<div class="entry"><div class="${headerClass}"><span class="morph">${highlightText(item.morph, q)}${indexHtml}</span><span class="pos-badge ${posClass}">${item.pos || '?'}</span><span class="gloss-main">${highlightText(glossDisplay, q)}</span></div>${allomorphsHtml}${examplesHtml}</div>`;
}

function getSortedData() {
    if (reverseMode) {
        const groups = new Map();
        for (const item of dictionaryData) {
            if (!groups.has(item.morph)) groups.set(item.morph, { morph: item.morph, glosses: [], pos: item.pos, allomorphs: new Set(), examples: [] });
            const g = groups.get(item.morph), base = item.gloss?.split('.')[0] || '';
            if (base && !g.glosses.includes(base)) g.glosses.push(base);
            (item.allomorphs || []).forEach(a => g.allomorphs.add(a));
            (item.examples || []).forEach(ex => { if (g.examples.length < 3 && !g.examples.some(e => e.text === ex.text)) g.examples.push(ex); });
        }
        return [...groups.values()].map(g => ({ morph: g.morph, gloss: g.glosses.sort((a, b) => getGojuonSortKey(a).localeCompare(getGojuonSortKey(b), 'ja'))[0] || '', glosses_all: g.glosses, pos: g.pos, allomorphs: [...g.allomorphs].sort(), examples: g.examples, morph_index: null })).sort((a, b) => getGojuonSortKey(a.gloss).localeCompare(getGojuonSortKey(b.gloss), 'ja'));
    }
    return [...dictionaryData].sort((a, b) => stripBoundary(a.morph).toLowerCase().localeCompare(stripBoundary(b.morph).toLowerCase()) || (a.pos || '').localeCompare(b.pos || ''));
}

// æ¤œç´¢ç”¨ï¼šå¢ƒç•Œè¨˜å·ã‚’é™¤å»
function stripBoundary(text) {
    if (!text) return '';
    return text.replace(/^[=~+-.]/, '');
}

function matchSearch(text, query, mode) {
    if (!text || !query) return false;
    const t = text.toLowerCase();
    const q = query.toLowerCase();
    switch(mode) {
        case 'exact': return t === q;
        case 'prefix': return t.startsWith(q);
        case 'suffix': return t.endsWith(q);
        default: return t.includes(q);
    }
}

// å½¢æ…‹ç´ æ¤œç´¢ç”¨ï¼šå¢ƒç•Œè¨˜å·ã‚’é™¤å»ã—ã¦æ¤œç´¢
function matchMorphSearch(text, query, mode) {
    if (!text || !query) return false;
    const t = stripBoundary(text).toLowerCase();
    const q = query.toLowerCase();
    switch(mode) {
        case 'exact': return t === q;
        case 'prefix': return t.startsWith(q);
        case 'suffix': return t.endsWith(q);
        default: return t.includes(q);
    }
}

function filterData() {
    return getSortedData().filter(item => {
        if (currentLetter) { 
            if (reverseMode) { 
                if (getGojuonRow(item.gloss) !== currentLetter) return false; 
            } else { 
                if (stripBoundary(item.morph).charAt(0).toLowerCase() !== currentLetter.toLowerCase()) return false; 
            } 
        }
        if (currentFilter && item.pos !== currentFilter) return false;
        if (searchQuery) {
            let match = false;
            if (searchTargets.morph && matchMorphSearch(item.morph, searchQuery, searchMode)) match = true;
            if (!match && searchTargets.gloss) {
                if (reverseMode && item.glosses_all) {
                    if (item.glosses_all.some(g => matchSearch(g, searchQuery, searchMode))) match = true;
                } else if (matchSearch(item.gloss, searchQuery, searchMode)) match = true;
            }
            if (!match && searchTargets.pos && matchSearch(item.pos, searchQuery, searchMode)) match = true;
            if (!match && searchTargets.allo && item.allomorphs?.some(a => matchMorphSearch(a, searchQuery, searchMode))) match = true;
            if (!match && searchTargets.trans && item.examples?.some(ex => matchSearch(ex.trans, searchQuery, searchMode))) match = true;
            if (!match) return false;
        }
        return true;
    });
}

function render() {
    const list = document.getElementById('dictionaryList'), stats = document.getElementById('stats');
    const filtered = filterData();
    list.innerHTML = filtered.length === 0 ? '<div class="no-results">è©²å½“ã™ã‚‹èªãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“</div>' : filtered.map(item => renderEntry(item, searchQuery)).join('');
    const exCount = filtered.reduce((s, i) => s + (i.examples?.length || 0), 0), transCount = filtered.reduce((s, i) => s + (i.examples?.filter(e => e.trans).length || 0), 0), audioCount = filtered.reduce((s, i) => s + (i.examples?.filter(e => e.audio_file).length || 0), 0);
    stats.textContent = `${reverseMode ? 'ã€é€†å¼•ãã€‘' : 'ã€è¦‹å‡ºã—é †ã€‘'} è¡¨ç¤º: ${filtered.length}èªï¼ˆç”¨ä¾‹: ${exCount}ä»¶ã€å’Œè¨³: ${transCount}ä»¶ã€éŸ³å£°: ${audioCount}ä»¶ï¼‰`;
}

function initAlphabetNav() {
    const nav = document.getElementById('alphabetNav'); nav.innerHTML = '';
    const allBtn = document.createElement('button'); allBtn.textContent = 'å…¨ã¦'; allBtn.className = 'active';
    allBtn.onclick = () => { currentLetter = null; nav.querySelectorAll('button').forEach(b => b.classList.remove('active')); allBtn.classList.add('active'); render(); };
    nav.appendChild(allBtn);
    if (reverseMode) {
        const used = new Set(dictionaryData.map(d => getGojuonRow(d.gloss)));
        gojuonRows.forEach(row => { if (used.has(row.label)) { const btn = document.createElement('button'); btn.textContent = row.label + 'è¡Œ'; btn.onclick = () => { currentLetter = row.label; nav.querySelectorAll('button').forEach(b => b.classList.remove('active')); btn.classList.add('active'); render(); }; nav.appendChild(btn); } });
    } else {
        [...new Set(dictionaryData.map(d => stripBoundary(d.morph).charAt(0).toLowerCase()))].sort().forEach(letter => { const btn = document.createElement('button'); btn.textContent = letter.toUpperCase(); btn.onclick = () => { currentLetter = letter; nav.querySelectorAll('button').forEach(b => b.classList.remove('active')); btn.classList.add('active'); render(); }; nav.appendChild(btn); });
    }
}

function initPosFilters() {
    const allPos = new Set(dictionaryData.map(d => d.pos).filter(Boolean)), filters = document.getElementById('posFilters'); filters.innerHTML = '';
    const allBtn = document.createElement('button'); allBtn.className = 'filter-btn active'; allBtn.textContent = 'å…¨å“è©';
    allBtn.onclick = () => { currentFilter = null; filters.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active')); allBtn.classList.add('active'); render(); };
    filters.appendChild(allBtn);
    ['V','N','ADJ','ADV','AUX','PRN','CP','ISP','SFP','INTJ','CONJ','VAFX','NAFX','FN','PN','CJP','LP'].forEach(pos => { if (allPos.has(pos)) { const btn = document.createElement('button'); btn.className = 'filter-btn'; btn.textContent = pos; btn.onclick = () => { currentFilter = pos; filters.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active')); btn.classList.add('active'); render(); }; filters.appendChild(btn); } });
}

document.getElementById('modeNormal').onclick = () => { reverseMode = false; document.getElementById('modeNormal').classList.add('active'); document.getElementById('modeReverse').classList.remove('active'); currentLetter = null; initAlphabetNav(); render(); };
document.getElementById('modeReverse').onclick = () => { reverseMode = true; document.getElementById('modeReverse').classList.add('active'); document.getElementById('modeNormal').classList.remove('active'); currentLetter = null; initAlphabetNav(); render(); };
document.getElementById('searchInput').oninput = (e) => { searchQuery = e.target.value; render(); };

// æ¤œç´¢ãƒ¢ãƒ¼ãƒ‰åˆ‡æ›¿
document.querySelectorAll('.search-option').forEach(function(opt) {
    opt.onclick = function() {
        document.querySelectorAll('.search-option').forEach(function(o) { o.classList.remove('active'); });
        opt.classList.add('active');
        searchMode = opt.dataset.mode;
        if (searchQuery) render();
    };
});

// æ¤œç´¢å¯¾è±¡åˆ‡æ›¿
document.querySelectorAll('.search-target').forEach(function(tgt) {
    tgt.onclick = function() {
        tgt.classList.toggle('active');
        searchTargets[tgt.dataset.target] = tgt.classList.contains('active');
        if (searchQuery) render();
    };
});

document.getElementById('totalCount').textContent = dictionaryData.length;
initAlphabetNav(); initPosFilters(); render();

function downloadCSV() {
    const escapeCSV = (str) => {
        if (!str) return '';
        str = String(str);
        // Excelã§æ•°å¼ã¨ã—ã¦è§£é‡ˆã•ã‚Œã‚‹è¨˜å·ã§å§‹ã¾ã‚‹å ´åˆã€å…ˆé ­ã«ã‚·ãƒ³ã‚°ãƒ«ã‚¯ã‚©ãƒ¼ãƒˆã‚’ä»˜ã‘ã‚‹
        if (/^[=+-@]/.test(str)) {
            str = "'" + str;
        }
        if (str.includes(',') || str.includes('"') || str.includes('\n')) {
            return '"' + str.replace(/"/g, '""') + '"';
        }
        return str;
    };
    
    // ãƒ˜ãƒƒãƒ€ãƒ¼
    const headers = ['morph', 'pos', 'gloss', 'allomorphs', 'morph_index', 'ex_text', 'ex_trans', 'ex_morphs', 'ex_glosses', 'ex_audio', 'ex_start', 'ex_end', 'ex_target'];
    let csv = headers.join(',') + '\n';
    
    for (const entry of dictionaryData) {
        const base = [
            escapeCSV(entry.morph),
            escapeCSV(entry.pos),
            escapeCSV(entry.gloss),
            escapeCSV((entry.allomorphs || []).join('|')),
            escapeCSV(entry.morph_index || '')
        ];
        
        if (entry.examples && entry.examples.length > 0) {
            for (const ex of entry.examples) {
                const row = [
                    ...base,
                    escapeCSV(ex.text),
                    escapeCSV(ex.trans),
                    escapeCSV((ex.morphs || []).join('|')),
                    escapeCSV((ex.glosses || []).join('|')),
                    escapeCSV(ex.audio_file),
                    escapeCSV(ex.start_time),
                    escapeCSV(ex.end_time),
                    escapeCSV(ex.target_index)
                ];
                csv += row.join(',') + '\n';
            }
        } else {
            csv += base.join(',') + ',,,,,,,,' + '\n';
        }
    }
    
    const bom = '\uFEFF';
    const blob = new Blob([bom + csv], { type: 'text/csv;charset=utf-8' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = 'dictionary.csv';
    a.click();
    URL.revokeObjectURL(url);
}
</script>
</body>
</html>